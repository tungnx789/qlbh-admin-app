<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QLBH Admin Dashboard</title>
    <link rel="stylesheet" href="css/admin.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <h1><i class="fas fa-cogs"></i> QLBH Admin Dashboard</h1>
            <div class="user-info">
                <span class="user-name">Admin</span>
                <i class="fas fa-user-circle"></i>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="nav">
        <div class="nav-content">
            <button class="nav-item active" data-module="dashboard">
                <i class="fas fa-chart-pie"></i> Dashboard
            </button>
            <button class="nav-item" data-module="tonkho">
                <i class="fas fa-boxes"></i> T·ªìn Kho
            </button>
            <button class="nav-item" data-module="nhaphang">
                <i class="fas fa-arrow-down"></i> Nh·∫≠p H√†ng
            </button>
            <button class="nav-item" data-module="banhang">
                <i class="fas fa-shopping-cart"></i> B√°n H√†ng
            </button>
            <button class="nav-item" data-module="xuathuy">
                <i class="fas fa-trash"></i> Xu·∫•t H·ªßy
            </button>
            <button class="nav-item" data-module="imei">
                <i class="fas fa-search"></i> T√¨m IMEI
            </button>
            <button class="nav-item" data-module="baocao">
                <i class="fas fa-chart-bar"></i> B√°o C√°o
            </button>
            <button class="nav-item" data-module="tools">
                <i class="fas fa-tools"></i> Tools
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Dashboard Module -->
        <div id="dashboard" class="module active">
            <div class="module-header">
                <h2><i class="fas fa-chart-pie"></i> Dashboard Overview</h2>
                <div class="header-actions">
                    <button class="btn btn-primary" onclick="admin.refreshDashboard()">
                        <i class="fas fa-sync-alt"></i> L√†m M·ªõi
                    </button>
                    <span id="dashboardLastUpdate" class="last-update"></span>
                </div>
            </div>

            <!-- Stats Cards -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-boxes"></i>
                    </div>
                    <div class="stat-content">
                        <h3>T·ªìn Kho</h3>
                        <div class="stat-number" id="totalTonKho">0</div>
                        <div class="stat-trend positive">+5.2%</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-dollar-sign"></i>
                    </div>
                    <div class="stat-content">
                        <h3>Doanh Thu Th√°ng</h3>
                        <div class="stat-number" id="totalRevenue">0</div>
                        <div class="stat-trend positive">+12.3%</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div class="stat-content">
                        <h3>L·ª£i Nhu·∫≠n Th√°ng</h3>
                        <div class="stat-number" id="totalProfit">0</div>
                        <div class="stat-trend positive">+8.1%</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-shopping-cart"></i>
                    </div>
                    <div class="stat-content">
                        <h3>B√°n Th√°ng</h3>
                        <div class="stat-number" id="totalBan">0</div>
                        <div class="stat-trend positive">+15.7%</div>
                    </div>
                </div>
            </div>

            <!-- Charts -->
            <div class="charts-grid">
                <div class="chart-container">
                    <h4><i class="fas fa-chart-line"></i> Doanh Thu Theo Th√°ng</h4>
                    <canvas id="revenueChart"></canvas>
                </div>
            </div>
        </div>

        <!-- TonKho Module -->
        <div id="tonkho" class="module">
            <div class="module-header">
                <h2><i class="fas fa-boxes"></i> Qu·∫£n L√Ω T·ªìn Kho</h2>
                <div class="actions">
                    <button class="btn btn-primary" onclick="addTonKho()">
                        <i class="fas fa-plus"></i> Th√™m M·ªõi
                    </button>
                    <button class="btn btn-secondary" onclick="syncTonKho()">
                        <i class="fas fa-sync-alt"></i> ƒê·ªìng B·ªô
                    </button>
                    <button class="btn btn-warning" onclick="recalculateTonKho()">
                        <i class="fas fa-calculator"></i> T√≠nh L·∫°i
                    </button>
                </div>
            </div>

            <!-- Filters -->
            <div class="filters">
                <div class="filter-group">
                    <input type="text" id="searchTonKho" placeholder="üîç T√¨m theo IMEI, D√≤ng m√°y..." class="filter-input">
                    <select id="filterDongMay" class="filter-select">
                        <option value="">T·∫•t c·∫£ d√≤ng m√°y</option>
                        <option value="iPhone 17 Pro Max">iPhone 17 Pro Max</option>
                        <option value="iPhone 16 Pro">iPhone 16 Pro</option>
                        <option value="iPhone 15 Pro Max">iPhone 15 Pro Max</option>
                    </select>
                    <select id="filterDungLuong" class="filter-select">
                        <option value="">T·∫•t c·∫£ dung l∆∞·ª£ng</option>
                        <option value="128GB">128GB</option>
                        <option value="256GB">256GB</option>
                        <option value="512GB">512GB</option>
                        <option value="1TB">1TB</option>
                    </select>
                    <button class="btn btn-info" onclick="applyTonKhoFilters()">
                        <i class="fas fa-filter"></i> L·ªçc
                    </button>
                </div>
            </div>

            <!-- Data Table -->
            <div class="table-container">
                <table id="tonkhoTable" class="data-table">
                    <thead>
                        <tr>
                            <th>STT</th>
                            <th>IMEI</th>
                            <th>IMEI V5</th>
                            <th>D√≤ng M√°y</th>
                            <th>Dung L∆∞·ª£ng</th>
                            <th>M√†u S·∫Øc</th>
                            <th>Gi√° Nh·∫≠p</th>
                            <th>Nh√† CC</th>
                            <th>Ng√†y Nh·∫≠p</th>
                            <th>Tr·∫°ng Th√°i</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="tonkhoTableBody">
                        <!-- Data s·∫Ω ƒë∆∞·ª£c load t·ª´ API -->
                    </tbody>
                </table>
            </div>

            <!-- Pagination -->
            <div class="pagination">
                <button class="btn btn-secondary" onclick="prevTonKhoPage()" id="prevTonKhoBtn">
                    <i class="fas fa-chevron-left"></i> Tr∆∞·ªõc
                </button>
                <span id="tonkhoPageInfo">Trang 1 / 1</span>
                <button class="btn btn-secondary" onclick="nextTonKhoPage()" id="nextTonKhoBtn">
                    Sau <i class="fas fa-chevron-right"></i>
                </button>
            </div>
        </div>

        <!-- NhapHang Module -->
        <div id="nhaphang" class="module">
            <div class="module-header">
                <h2><i class="fas fa-arrow-down"></i> L·ªãch S·ª≠ Nh·∫≠p H√†ng</h2>
                <div class="actions">
                    <button class="btn btn-primary" onclick="addNhapHang()">
                        <i class="fas fa-plus"></i> Th√™m Nh·∫≠p
                    </button>
                    <button class="btn btn-info" onclick="exportNhapHang()">
                        <i class="fas fa-download"></i> Export
                    </button>
                </div>
            </div>

            <!-- Filters -->
            <div class="filters">
                <div class="filter-group">
                    <input type="date" id="nhapDateFrom" class="filter-input" placeholder="T·ª´ ng√†y">
                    <input type="date" id="nhapDateTo" class="filter-input" placeholder="ƒê·∫øn ng√†y">
                    <input type="text" id="searchNhapHang" placeholder="üîç T√¨m theo IMEI, NCC..." class="filter-input">
                    <select id="filterNCC" class="filter-select">
                        <option value="">T·∫•t c·∫£ NCC</option>
                        <option value="NCC A">NCC A</option>
                        <option value="NCC B">NCC B</option>
                    </select>
                    <button class="btn btn-info" onclick="applyNhapHangFilters()">
                        <i class="fas fa-filter"></i> L·ªçc
                    </button>
                </div>
            </div>

            <!-- Data Table -->
            <div class="table-container">
                <table id="nhaphangTable" class="data-table">
                    <thead>
                        <tr>
                            <th>STT</th>
                            <th>Ng√†y Nh·∫≠p</th>
                            <th>IMEI</th>
                            <th>IMEI V5</th>
                            <th>D√≤ng M√°y</th>
                            <th>Dung L∆∞·ª£ng</th>
                            <th>M√†u S·∫Øc</th>
                            <th>Gi√° Nh·∫≠p</th>
                            <th>Nh√† CC</th>
                            <th>M√¥ T·∫£</th>
                            <th>TX_NHAP</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="nhaphangTableBody">
                        <!-- Data s·∫Ω ƒë∆∞·ª£c load t·ª´ API -->
                    </tbody>
                </table>
            </div>

            <!-- Pagination -->
            <div class="pagination">
                <button class="btn btn-secondary" onclick="prevNhapHangPage()" id="prevNhapHangBtn">
                    <i class="fas fa-chevron-left"></i> Tr∆∞·ªõc
                </button>
                <span id="nhaphangPageInfo">Trang 1 / 1</span>
                <button class="btn btn-secondary" onclick="nextNhapHangPage()" id="nextNhapHangBtn">
                    Sau <i class="fas fa-chevron-right"></i>
                </button>
            </div>
        </div>

        <!-- BanHang Module -->
        <div id="banhang" class="module">
            <div class="module-header">
                <h2><i class="fas fa-shopping-cart"></i> B√°n H√†ng Theo Th√°ng</h2>
                <div class="month-selector">
                    <select id="monthSelector" onchange="loadBanHangMonth()" class="filter-select">
                        <option value="01">Th√°ng 1</option>
                        <option value="02">Th√°ng 2</option>
                        <option value="03">Th√°ng 3</option>
                        <option value="04">Th√°ng 4</option>
                        <option value="05">Th√°ng 5</option>
                        <option value="06">Th√°ng 6</option>
                        <option value="07">Th√°ng 7</option>
                        <option value="08">Th√°ng 8</option>
                        <option value="09">Th√°ng 9</option>
                        <option value="10">Th√°ng 10</option>
                        <option value="11">Th√°ng 11</option>
                        <option value="12">Th√°ng 12</option>
                    </select>
                    <button class="btn btn-primary" onclick="addBanHang()">
                        <i class="fas fa-plus"></i> Th√™m B√°n
                    </button>
                </div>
            </div>

            <!-- Month Summary -->
            <div class="month-summary">
                <div class="summary-card">
                    <h4><i class="fas fa-chart-bar"></i> Th·ªëng K√™ Th√°ng</h4>
                    <div class="stats">
                        <div class="stat">
                            <span class="label">T·ªïng B√°n:</span>
                            <span class="value" id="totalSales">0</span>
                        </div>
                        <div class="stat">
                            <span class="label">Doanh Thu:</span>
                            <span class="value" id="totalRevenue">0</span>
                        </div>
                        <div class="stat">
                            <span class="label">L·ª£i Nhu·∫≠n:</span>
                            <span class="value" id="totalProfit">0</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Data Table -->
            <div class="table-container">
                <table id="banhangTable" class="data-table">
                    <thead>
                        <tr>
                            <th>STT</th>
                            <th>Ng√†y B√°n</th>
                            <th>IMEI</th>
                            <th>IMEI V5</th>
                            <th>D√≤ng M√°y</th>
                            <th>Dung L∆∞·ª£ng</th>
                            <th>M√†u S·∫Øc</th>
                            <th>Gi√° B√°n</th>
                            <th>Gi√° Nh·∫≠p</th>
                            <th>L·ª£i Nhu·∫≠n</th>
                            <th>Kh√°ch H√†ng</th>
                            <th>M√¥ T·∫£ B√°n</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="banhangTableBody">
                        <!-- Data s·∫Ω ƒë∆∞·ª£c load t·ª´ API -->
                    </tbody>
                </table>
            </div>

            <!-- Pagination -->
            <div class="pagination">
                <button class="btn btn-secondary" onclick="prevBanHangPage()" id="prevBanHangBtn">
                    <i class="fas fa-chevron-left"></i> Tr∆∞·ªõc
                </button>
                <span id="banhangPageInfo">Trang 1 / 1</span>
                <button class="btn btn-secondary" onclick="nextBanHangPage()" id="nextBanHangBtn">
                    Sau <i class="fas fa-chevron-right"></i>
                </button>
            </div>
        </div>

        <!-- XuatHuy Module -->
        <div id="xuathuy" class="module">
            <div class="module-header">
                <h2><i class="fas fa-trash"></i> Xu·∫•t H·ªßy / Tr·∫£ NCC</h2>
                <div class="actions">
                    <button class="btn btn-primary" onclick="addXuatHuy()">
                        <i class="fas fa-plus"></i> Th√™m Xu·∫•t H·ªßy
                    </button>
                    <button class="btn btn-info" onclick="exportXuatHuy()">
                        <i class="fas fa-download"></i> Export
                    </button>
                </div>
            </div>

            <!-- Data Table -->
            <div class="table-container">
                <table id="xuathuyTable" class="data-table">
                    <thead>
                        <tr>
                            <th>STT</th>
                            <th>Ng√†y Xu·∫•t H·ªßy</th>
                            <th>Lo·∫°i Xu·∫•t H·ªßy</th>
                            <th>IMEI</th>
                            <th>IMEI V5</th>
                            <th>D√≤ng M√°y</th>
                            <th>Dung L∆∞·ª£ng</th>
                            <th>M√†u S·∫Øc</th>
                            <th>Gi√° Nh·∫≠p</th>
                            <th>Nh√† CC</th>
                            <th>Ph√≠ Xu·∫•t H·ªßy</th>
                            <th>M√¥ T·∫£ Xu·∫•t H·ªßy</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="xuathuyTableBody">
                        <!-- Data s·∫Ω ƒë∆∞·ª£c load t·ª´ API -->
                    </tbody>
                </table>
            </div>

            <!-- Pagination -->
            <div class="pagination">
                <button class="btn btn-secondary" onclick="prevXuatHuyPage()" id="prevXuatHuyBtn">
                    <i class="fas fa-chevron-left"></i> Tr∆∞·ªõc
                </button>
                <span id="xuathuyPageInfo">Trang 1 / 1</span>
                <button class="btn btn-secondary" onclick="nextXuatHuyPage()" id="nextXuatHuyBtn">
                    Sau <i class="fas fa-chevron-right"></i>
                </button>
            </div>
        </div>

        <!-- IMEI Search Module -->
        <div id="imei" class="module">
            <div class="module-header">
                <h2><i class="fas fa-search"></i> T√¨m L·ªãch S·ª≠ IMEI</h2>
            </div>

            <div class="search-form">
                <div class="search-input-group">
                    <input type="text" id="imeiSearch" placeholder="Nh·∫≠p IMEI (c√≥ th·ªÉ nhi·ªÅu IMEI c√°ch nhau b·∫±ng d·∫•u ph·∫©y)" class="search-input">
                    <button class="btn btn-primary" onclick="searchIMEI()">
                        <i class="fas fa-search"></i> T√¨m Ki·∫øm
                    </button>
                </div>
            </div>

            <div class="search-results" id="imeiResults" style="display:none">
                <h3><i class="fas fa-history"></i> L·ªãch S·ª≠ Giao D·ªãch</h3>
                <div class="imei-timeline" id="imeiTimeline">
                    <!-- Timeline s·∫Ω ƒë∆∞·ª£c render t·ª´ API -->
                </div>
            </div>
        </div>

        <!-- BaoCao Module -->
        <div id="baocao" class="module">
            <div class="module-header">
                <h2><i class="fas fa-chart-bar"></i> B√°o C√°o</h2>
                <div class="header-actions">
                    <button class="btn btn-primary" onclick="admin.refreshBaoCao()">
                        <i class="fas fa-sync-alt"></i> L√†m M·ªõi
                    </button>
                    <span id="baocaoLastUpdate" class="last-update"></span>
                </div>
            </div>

            <div class="baocao-container">
                <!-- B√°o C√°o T·ªìn Kho -->
                <div class="baocao-tonkho">
                    <div class="section-header">
                        <h3>üì¶ B√°o C√°o T·ªìn Kho</h3>
                        <button class="btn btn-sm btn-primary" onclick="admin.refreshBaoCao()">
                            üîÑ C·∫≠p Nh·∫≠t
                        </button>
                    </div>
                    
                    <div class="baocao-summary">
                        <div class="summary-item">
                            <span class="label">T·ªïng S·ªë L∆∞·ª£ng:</span>
                            <span id="totalQuantity" class="value">0</span>
                        </div>
                        <div class="summary-item">
                            <span class="label">T·ªïng Gi√° Tr·ªã:</span>
                            <span id="totalValue" class="value">0 ƒë</span>
                        </div>
                    </div>

                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>STT</th>
                                    <th>D√≤ng M√°y</th>
                                    <th>S·ªë L∆∞·ª£ng</th>
                                    <th>Gi√° Tr·ªã</th>
                                </tr>
                            </thead>
                            <tbody id="baocaoTableBody">
                                <!-- Data will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- TOP S·∫¢N PH·∫®M B√ÅN CH·∫†Y -->
                <div class="baocao-topproducts">
                    <div class="section-header">
                        <h3>üèÜ TOP S·∫¢N PH·∫®M B√ÅN CH·∫†Y</h3>
                        <div class="top-products-controls">
                            <input type="number" id="topProductsDays" placeholder="S·ªë ng√†y" value="120" class="filter-input">
                            <button class="btn btn-sm btn-primary" onclick="admin.refreshTopProducts()">
                                üìä Th·ªëng K√™
                            </button>
                        </div>
                    </div>
                    
                    <div id="topProductsLoading" class="loading-indicator" style="display: none;">
                        <i class="fas fa-spinner fa-spin"></i> ƒêang t√≠nh to√°n...
                    </div>
                    
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>STT</th>
                                    <th>D√≤ng M√°y</th>
                                    <th>S·ªë L∆∞·ª£ng</th>
                                </tr>
                            </thead>
                            <tbody id="topProductsTableBody">
                                <!-- Data will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="last-update">
                        <span id="topproductsLastUpdate"></span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tools Module -->
        <div id="tools" class="module">
            <div class="module-header">
                <h2><i class="fas fa-tools"></i> Admin Tools</h2>
            </div>

            <div class="tools-grid">
                <div class="tool-card">
                    <h3><i class="fas fa-sync-alt"></i> ƒê·ªìng B·ªô D·ªØ Li·ªáu</h3>
                    <p>ƒê·ªìng b·ªô th√¥ng tin t·ª´ NhapHang sang TonKho</p>
                    <button class="btn btn-primary" onclick="syncData()">ƒê·ªìng B·ªô</button>
                </div>
                <div class="tool-card">
                    <h3><i class="fas fa-calculator"></i> T√≠nh L·ª£i Nhu·∫≠n</h3>
                    <p>T√≠nh l·∫°i l·ª£i nhu·∫≠n cho t·∫•t c·∫£ giao d·ªãch b√°n</p>
                    <button class="btn btn-warning" onclick="calculateProfit()">T√≠nh L·∫°i</button>
                </div>
                <div class="tool-card">
                    <h3><i class="fas fa-balance-scale"></i> ƒê·ªëi Chi·∫øu T·ªìn Kho</h3>
                    <p>So s√°nh TonKho v·ªõi TinhTonKho</p>
                    <button class="btn btn-info" onclick="compareTonKho()">ƒê·ªëi Chi·∫øu</button>
                </div>
                <div class="tool-card">
                    <h3><i class="fas fa-save"></i> Backup D·ªØ Li·ªáu</h3>
                    <p>T·∫°o backup v√† g·ª≠i email</p>
                    <button class="btn btn-success" onclick="backupData()">Backup</button>
                </div>
            </div>
        </div>
    </main>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay" style="display: none;">
        <div class="loading-spinner">
            <i class="fas fa-spinner fa-spin"></i>
            <p>ƒêang t·∫£i d·ªØ li·ªáu...</p>
        </div>
    </div>

    <!-- Modal for Add/Edit -->
    <div id="modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">Th√™m M·ªõi</h3>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body" id="modalBody">
                <!-- Form content will be loaded here -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal()">H·ªßy</button>
                <button class="btn btn-primary" onclick="saveModal()">L∆∞u</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/admin.js"></script>
</body>
</html>


